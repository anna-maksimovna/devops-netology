# Домашнее задание к занятию "10.06. Инцидент-менеджмент"
### Задание
**Составьте постмортем, на основе реального сбоя системы Github в 2018 году.**

**Информация о сбое доступна в виде краткой выжимки на русском языке , а также развёрнуто на английском языке.**

#### *Постмортем*

| Краткое описание инцидента | 21 октября 2018 года в GitHub произошел инцидент, который привел к снижению качества обслуживания на 24 часа 11 минут. Никакие пользовательские данные не были потеряны.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Предшествующие события     | В 22:52 21 октября проводились плановые работы по замене вышедшего из строя оптического оборудования.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Причина инцидента          | Плановые работы привели к потере связи между нашим сетевым концентратором на восточном побережье США и нашим основным data-центром на восточном побережье США. Связь между этими точками была восстановлена за 43 секунды, но этот кратковременный сбой вызвал цепочку событий, которые привели к ухудшению качества обслуживания на 24 часа 11 минут.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Воздействие                | Отображалась устаревшая и непоследовательная информация. В большинстве случаев GitHub также не мог обслуживать webhook-события или создавать и публиковать GitHub Pages.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Обнаружение                | Внутренние системы мониторинга начали генерировать предупреждения, указывающие на многочисленные сбои в наших системах.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Реакция                    | Вызваны инженеры из группы разработки БД GitHub.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Восстановление             | Остановлены веб-хуки и сборки GitHub Pages, восстановлены резервные копии, синхронизированы реплики, обработаны веб-хуки из очереди.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Таймлайн                   | 21.10.2018 22:52  Произошло временное отключение основного Восточного data-центра. После восстановления Восточного ЦОДа, он содержал данные, которые не были реплицированы, оба кластера содержали данные для записи, отсутствующие в другом ЦОДе, невозможно было выполнить безопасное восстановление данных. 21.10.2018 22:54 Внутренние системы мониторинга начали генерировать предупреждения, указывающие на многочисленные сбои в наших системах. 21.10.2018 23:02 Инженеры нашей группы быстрого реагирования определили, что кластеры баз данных находятся в непредвиденном состоянии. Топология репликации базы данных включала только серверы из Западного data-центра. 21.10.2018 23:07 Ответственная команда решила вручную заблокировать наш внутренний инструмент развертывания, чтобы предотвратить внесение каких-либо дополнительных изменений. 21.10.2018 23:09 Группа реагирования установила желтый статус. Это действие автоматически переводит ситуацию в активный инцидент и отправляет предупреждение координатору инцидентов. 21.10.2018 23:11 Присоединился координатор инцидента и через две минуты изменил статус решения на красный. 21.10.2018 23:13 Были вызваны дополнительные инженеры из группы разработки баз данных GitHub. Они начали исследовать текущее состояние, чтобы определить, какие действия необходимо предпринять 21.10.2018 23:19 Мы приняли решение частично ухудшить удобство использования сайта, приостановив работу webhook и сборки GitHub Pages вместо того, чтобы подвергать опасности данные, которые мы уже получили от пользователей. 22.10.2018 00:05 Инженеры, участвующие в группе реагирования на инциденты, начали разработку плана по устранению несоответствий данных и внедрению наших процедур аварийного переключения для MySQL. 22.10.2018 00:41 Был инициирован процесс резервного копирования для всех затронутых кластеров MySQL, и инженеры следили за его ходом. Одновременно несколько групп инженеров искали способы ускорить передачу и время восстановления без дальнейшего ухудшения удобства использования сайта или риска повреждения данных. 22.10.2018 06:51 Несколько кластеров завершили восстановление из резервных копий в нашем центре обработки данных на восточном побережье США и начали репликацию новых данных с западного побережья. 22.10.2018 07:46 GitHub опубликовал сообщение в блоге, чтобы предоставить больше контекста. 22.10.2018 11:12 Все первичные базы данных снова установлены на восточном побережье США. 22.10.2018 13:15 К настоящему времени мы приближались к пиковой нагрузке трафика на GitHub.com. Группа реагирования на инциденты обсудила, как действовать дальше. 22.10.2018 16:24 Как только реплики были синхронизированы, мы выполнили аварийное переключение на исходную топологию, решив немедленные проблемы с задержкой/доступностью. 22.10.2018 16:45 На этом этапе восстановления нам нужно было сбалансировать возросшую нагрузку, представленную отставанием, потенциально перегружая наших партнеров по экосистеме уведомлениями, и как можно быстрее вернуть наши услуги на 100%. 22.10.2018 23:03 Все ожидающие сборки webhook и GitHub Pagesбыли обработаны, и была подтверждена целостность и правильная работа всех систем. Статус был обновлен до зеленого. |
| Последующие действия       | Собраны логи записей, которые не были реплицированы. Настроена конфигурация Orchestrator для предотвращения продвижение основных баз данных через региональные границы. Ускорили переход на новый механизм отчетов о состоянии. В будущем мы будем отображать различные компоненты платформы, чтобы вы знали статус каждой службы. Начали общекорпоративную инженерную инициативу по поддержке обслуживания трафика GitHub. Цель этой работы — допустить полный отказ одного центра обработки данных без воздействия на пользователя. Начнем системную практику проверки сценариев сбоев, прежде чем они смогут повлиять на вас. Будем развивать инструменты внедрения ошибок и хаос-инжиниринга в GitHub.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |