# Домашнее задание к занятию "12.3 Развертывание кластера на собственных серверах, лекция 1"

> Поработав с персональным кластером, можно заняться проектами. Вам пришла задача подготовить кластер под новый проект.

### Задание 1: Описать требования к кластеру

> Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

> * База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
> * Кэш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
> * Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.
> * Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.


### Решение:

**Расчет всех необходимых ресурсов:**

Для БД: 12ГБ ОЗУ, 3 ядра.

Для кэша: 12ГБ ОЗУ, 3 ядра. 

Фронтенд: 250 Мб ОЗУ, 1 ядро.

Бекенд: 6Гб ОЗУ и 10 ядер.

Итого: 31Гб ОЗУ и 17 ядер.

**Количество рабочих нод, которые справятся с такой нагрузкой:**

Control Plane нод можно выделить 3 ноды по 2 ядра и 2 Гб.

Для рабочей ноды получается необходима нода на 32 Гб ОЗУ и 17 ядер или можно разбить на несколько, например, на 4 ноды.

**Добавьте к полученным цифрам запас, который учитывает выход из строя как минимум одной ноды:**

Для мастер ноды: если одна выйдет из строя, то останутся другие две ноды. По идее для отказоустойчивости 3 ноды подойдет, но можно и больше. 

Для рабочих нод: можно тогда разделить на 4 ноды по 5 ядер и 8 Гб ОЗУ. С учетом, что одна выйдет из строя, получится: по 6 ядер и 12Гб должно хватить.

**Добавьте служебные ресурсы к нодам. Помните, что для разных типов нод требовния к ресурсам разные:**

Исходя из требований для Control Plane (2 ядра, 2 Гб ОЗУ, 50 ГБ диск) и расчета на 3 ноды, получаем по 2 ядра и 2 Гб ОЗУ, по 50 ГБ диск

Исходя из требований для рабочей ноды (1 ядро, 1 Гб ОЗУ, 100 ГБ диск) и расчета на 4 ноды, получаем по 4 ядра, 4 Гб ОЗУ, 100 ГБ диск    

**Рассчитайте итоговые цифры.**
**В результате должно быть указано количество нод и их параметры.**

### Итого: 

3 мастер-ноды по 2 ядра, 2 Гб ОЗУ, по 50 ГБ диск

4 рабочих ноды по 7 ядер, 12 Гб ОЗУ, 100 ГБ диск  - такое количество и значения покрывают необходимые 21 ядро и 35 ГБ ОЗУ для рабочих нод с учетом, что одна нода может отвалиться.